(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{Ke7H:function(e,t,n){"use strict";n.r(t),n.d(t,"ChangeLicenceModule",function(){return w});var i=n("ofXK"),r=n("ebz3"),a=n("mkVx"),s=n("904P"),c=n("1kSV"),o=n("tyNb"),l=n("mrSG"),m=n("PdH4"),d=n.n(m),u=n("e1b5"),p=n("wo4V"),h=n("Km9j"),v=n("fXoL"),g=n("PQpq"),f=n("6mAB"),y=n("gren"),S=n("kwXE"),b=n("/n7v");function x(e,t){if(1&e){const e=v["\u0275\u0275getCurrentView"]();v["\u0275\u0275elementStart"](0,"div",22),v["\u0275\u0275elementStart"](1,"app-card",23),v["\u0275\u0275elementStart"](2,"div",24),v["\u0275\u0275elementStart"](3,"div",25),v["\u0275\u0275elementStart"](4,"div",26),v["\u0275\u0275elementStart"](5,"span",27),v["\u0275\u0275text"](6),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](7,"div",28),v["\u0275\u0275element"](8,"img",29),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](9,"div",30),v["\u0275\u0275elementStart"](10,"a",31),v["\u0275\u0275elementStart"](11,"h4",32),v["\u0275\u0275text"](12),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](13,"p",33),v["\u0275\u0275elementStart"](14,"a",34),v["\u0275\u0275text"](15),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](16,"button",35),v["\u0275\u0275listener"]("click",function(){v["\u0275\u0275restoreView"](e);const n=t.$implicit;return v["\u0275\u0275nextContext"]().LaunchPayModal(n)}),v["\u0275\u0275element"](17,"i",36),v["\u0275\u0275text"](18),v["\u0275\u0275pipe"](19,"formatMoney"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;v["\u0275\u0275advance"](1),v["\u0275\u0275property"]("hidHeader",!0),v["\u0275\u0275advance"](5),v["\u0275\u0275textInterpolate1"]("Dur\xe9e : ",e.duree," Jours"),v["\u0275\u0275advance"](6),v["\u0275\u0275textInterpolate"](e.nom),v["\u0275\u0275advance"](3),v["\u0275\u0275textInterpolate"](e.description),v["\u0275\u0275advance"](3),v["\u0275\u0275textInterpolate1"](" Payer (",v["\u0275\u0275pipeBind1"](19,5,e.montant)," FCFA)")}}const E=[{path:"",component:(()=>{class e{constructor(e,t,n,i,r,a){this.profilService=e,this.libraryService=t,this.ngxService=n,this.locStorService=i,this.route=r,this.router=a,this.isLoading=!1,this.isLicenceOk=!1,this.request=new p.a,this.iLicence=new u.a,this.isUserOk=!1,this.codeCustomer="",this.isCheckingProfile=!1}ngOnInit(){this.user=this.locStorService.readFromSession("licence_user"),this.getModulesList(),this.getFPrint()}ngOnDestroy(){}goBack(){this.router.navigate(["/auth/connection"])}getFPrint(){this.profilService.getFPrint().then(e=>{this.fprint=e.name,this.request.fprint=this.fprint},e=>{d.a.fire({customClass:{container:"myCustomSwal"},icon:"error",title:"Une erreur est survenue lors du test de votre configuration"})})}getCurrentLicence(){this.profilService.getLastLicenceForUpdate().then(e=>{this.request.code=e.name},e=>{d.a.fire({customClass:{container:"myCustomSwal"},icon:"error",title:"Une erreur est survenue lors de la v\xe9rification de votre licence"})})}getModulesList(){this.profilService.getModulesFu().then(e=>{this.modulesList=e.data},e=>{d.a.fire({customClass:{container:"myCustomSwal"},icon:"error",title:"Une erreur est survenue lors du chargement des modules"})})}askForLicence(e){this.ngxService.start(),this.isLoading=!0,this.request.id_company=this.user.agency.company.id,this.request.nom_company=this.user.agency.company.name,this.request.adresse_company=this.user.agency.company.address,this.request.telephone_company=this.user.agency.company.phone,this.request.secteur=this.user.agency.company.description,this.request.nom_admin=this.user.user.lastname,this.request.prenom_admin=this.user.user.firstname,this.request.telephone_admin=this.user.user.phone,this.request.module=e,this.request.code=this.user.agency.company.currentLicence.code,this.profilService.askForLicenceUpdate(this.request).then(e=>{if("success"===e.status)return this.iLicence.company=this.user.agency.company,this.iLicence.isActive=!0,this.iLicence.code=e.code_client,this.iLicence.key=e.alea,this.iLicence.activationDate=e.date_activation.date,this.iLicence.expiryDate=e.date_expiration.date,this.iLicence.activationCost=this.request.module.montant,this.iLicence.module=this.request.module.nom,void this.saveLicence(this.iLicence);this.isLoading=!1,this.ngxService.stop(),d.a.fire({customClass:{container:"myCustomSwal"},icon:"error",title:e.message})},e=>{this.isLoading=!1,this.ngxService.stop(),d.a.fire(401===e.status?{customClass:{container:"myCustomSwal"},icon:"error",title:e._body}:{customClass:{container:"myCustomSwal"},icon:"error",title:"Une erreur est survenue lors de la connexion"})})}saveLicence(e){this.profilService.updateLicenceChange(e).then(e=>{this.iLicence.key="",this.isLoading=!1,this.ngxService.stop(),null===e?d.a.fire({customClass:{container:"myCustomSwal"},icon:"error",title:"Une erreur est survenue"}):(this.ngxService.stop(),this.isLicenceOk=!0,this.iLicence=e,this.request=new p.a,localStorage.removeItem("licence_user"),this.SuccessOperationModal(this.iLicence),this.goBack())},e=>{this.isLoading=!1,401===e.status?(d.a.fire({customClass:{container:"myCustomSwal"},icon:"error",title:e._body}),this.goBack()):d.a.fire({customClass:{container:"myCustomSwal"},icon:"error",title:"Une erreur est survenue."})})}loginNow(){this.router.navigate(["/login"])}getLicenceStatus(e){return!0===e?"ACTIVEE":"INACTIVE"}isCodeCustomerRight(){return void 0!==this.codeCustomer&&""!==this.codeCustomer&&!(this.codeCustomer.length<5)}SuccessOperationModal(e){return Object(l.a)(this,void 0,void 0,function*(){let t=new i.d("en-US").transform(e.activationDate,"dd/MM/yyyy"),n=new i.d("en-US").transform(e.expiryDate,"dd/MM/yyyy");d.a.fire({title:"Mis \xe0 jour r\xe9ussie!",icon:"success",html:'<br><div class="row"><p class="mb-2 col-sm-9 f-16 text-left"><i class="feather icon-check-circle mr-2 text-primary"></i> Code Client : </p> <p class="badge col-sm-3 badge-success">'+e.code+'</p></div><div class="row"><p class="mb-2 col-sm-9 f-16 text-left"><i class="feather icon-check-circle mr-2 text-primary"></i> Votre licence est : </p><p class="badge col-sm-3 badge-success">'+this.getLicenceStatus(e.isActive)+'</p></div><div class="row"><p class="mb-2 col-sm-9 f-16 text-left"><i class="feather icon-check-circle mr-2 text-primary"></i> Commence le : </p><p class="badge col-sm-3 badge-success">'+t+'</p></div><div class="row"><p class="mb-2 col-sm-9 f-16 text-left"><i class="feather icon-check-circle mr-2 text-primary"></i> Expire le : </p><p class="badge col-sm-3 badge-success">'+n+"</p></div>"})})}LaunchPayModal(e){return Object(l.a)(this,void 0,void 0,function*(){let t=(new h.a).transform(e.montant,"");yield d.a.fire({customClass:{container:"myCustomSwal",confirmButton:"btn btn-primary",cancelButton:"btn btn-light",denyButton:"btn btn-warning"},icon:"info",title:"DEMARRAGE DU PROCESSUS DE PAIEMENT",html:'<br><p class="text-center h4"> Un processus de paiement d\'un montant de <span class="badge badge-success mt-1">'+t+' FCFA </span> sera lanc\xe9 sur le num\xe9ro de t\xe9l\xe9phone suivant : <span class="badge badge-success mt-1">'+this.user.user.phone+'</span> </p><p class="text-center font-weight-bold h3 text-warning">Voulez-vous modifier ce num\xe9ro ?</p>',showDenyButton:!0,showCancelButton:!0,showCloseButton:!0,confirmButtonText:'<i class="feather icon-check-circle"></i> Continuer',denyButtonText:'<i class="feather icon-edit-1"></i> Oui, Modifier',denyButtonColor:"#ff9800",cancelButtonText:'<i class="feather icon-x-circle"></i> Annuler',reverseButtons:!0,buttonsStyling:!0}).then(t=>{t.isConfirmed?this.askForLicence(e):t.isDenied&&this.changePayNumber(e)})})}changePayNumber(e){return Object(l.a)(this,void 0,void 0,function*(){let t=this.user.user.phone.substring(5).replaceAll("-","");yield d.a.fire({customClass:{container:"myCustomSwal",confirmButton:"btn btn-primary"},title:"MODIFICATION DU NUMERO DE PAIEMENT",imageUrl:"assets/images/params/payPhoneNumb.png",imageHeight:122,imageWidth:200,showCancelButton:!0,input:"text",inputValue:t,inputLabel:"Num\xe9ro de paiement",inputPlaceholder:"Veuillez saisir le num\xe9ro de paiement",inputValidator:e=>{let t=/^(?:9[01456789]|6[0123456789]|5[01234])[0-9]{6}$/.test(e);if(!e||!t)return"Num\xe9ro de t\xe9l\xe9phone Invalide!"},inputAttributes:{maxlength:8,autocapitalize:"off",autocorrect:"off"},cancelButtonText:'<i class="feather icon-x-circle"></i> Annuler',confirmButtonText:'<i class="feather icon-check-circle"></i> Confirmer',reverseButtons:!0,buttonsStyling:!0}).then(t=>{if(t.isConfirmed){let n=t.value.match(/\d{2}/g).join("-");this.user.user.phone="+229 "+n,this.LaunchPayModal(e)}else this.LaunchPayModal(e)})})}}return e.\u0275fac=function(t){return new(t||e)(v["\u0275\u0275directiveInject"](g.a),v["\u0275\u0275directiveInject"](f.a),v["\u0275\u0275directiveInject"](y.b),v["\u0275\u0275directiveInject"](S.a),v["\u0275\u0275directiveInject"](o.a),v["\u0275\u0275directiveInject"](o.f))},e.\u0275cmp=v["\u0275\u0275defineComponent"]({type:e,selectors:[["app-change-licence"]],decls:66,vars:13,consts:[[3,"hidHeader","options"],[1,"row","btn-page"],[1,"col-xl-3"],["cardClass","task-board-left",3,"hidHeader","options"],[1,"task-right"],["type","button","ngbTooltip","Retour Vers la Page de Connection",1,"btn","btn-primary",3,"placement","click"],[1,"fas","fa-chevron-circle-left"],["id","completeStatus",1,"taskboard-right-progress"],["aria-label","breadcrumb"],[1,"breadcrumb","d-flex","justify-content-center"],["aria-current","page",1,"breadcrumb-item"],[1,"m-t-10","text-primary"],[1,"float-right","text-dark"],[1,"progress"],["role","progressbar","aria-valuenow","0","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","bg-success",2,"width","0%"],[1,"col-xl-9","filter-bar","invoice-list"],[1,"navbar","m-b-30","p-10","d-flex","justify-content-around"],[1,"nav-item","nav-grid"],["type","button",1,"btn","btn-primary"],[1,"fas","fa-th-large"],[1,"row"],["class","col-lg-4 col-md-6",4,"ngFor","ngForOf"],[1,"col-lg-4","col-md-6"],["cardClass","user-card user-card-1 mt-4","blockClass","pt-0 pb-2",3,"hidHeader"],[1,"user-about-block","text-center"],[1,"row","align-items-end"],[1,"col","text-left","pb-3"],[1,"badge","badge-info"],[1,"col"],["src","assets/images/pages/medal-platinum.svg","alt","User image",1,"img-radius","img-fluid","wid-80"],[1,"text-center"],["href","javascript:","data-toggle","modal","data-target","#modal-report"],[1,"mb-1","mt-3"],[1,"mb-1"],[1,"text-primary"],[1,"btn","btn-primary","mt-1","font-weight-bold",3,"click"],[1,"fas","fa-money-bill-wave"]],template:function(e,t){1&e&&(v["\u0275\u0275elementStart"](0,"app-card",0),v["\u0275\u0275elementStart"](1,"div",1),v["\u0275\u0275elementStart"](2,"div",2),v["\u0275\u0275elementStart"](3,"app-card",3),v["\u0275\u0275elementStart"](4,"div",4),v["\u0275\u0275elementStart"](5,"button",5),v["\u0275\u0275listener"]("click",function(){return t.goBack()}),v["\u0275\u0275element"](6,"i",6),v["\u0275\u0275text"](7," Retour "),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](8,"div",7),v["\u0275\u0275elementStart"](9,"nav",8),v["\u0275\u0275elementStart"](10,"ol",9),v["\u0275\u0275elementStart"](11,"li",10),v["\u0275\u0275text"](12,"INFORMATIONS ENTREPRISE"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](13,"h6",11),v["\u0275\u0275text"](14,"Nom: "),v["\u0275\u0275elementStart"](15,"span",12),v["\u0275\u0275text"](16),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](17,"div",13),v["\u0275\u0275element"](18,"div",14),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](19,"h6",11),v["\u0275\u0275text"](20,"T\xe9l\xe9phone: "),v["\u0275\u0275elementStart"](21,"span",12),v["\u0275\u0275text"](22),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](23,"div",13),v["\u0275\u0275element"](24,"div",14),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](25,"h6",11),v["\u0275\u0275text"](26,"Adresse: "),v["\u0275\u0275elementStart"](27,"span",12),v["\u0275\u0275text"](28),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](29,"div",13),v["\u0275\u0275element"](30,"div",14),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](31,"h6",11),v["\u0275\u0275text"](32,"Secteur: "),v["\u0275\u0275elementStart"](33,"span",12),v["\u0275\u0275text"](34),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](35,"div",13),v["\u0275\u0275element"](36,"div",14),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](37,"nav",8),v["\u0275\u0275elementStart"](38,"ol",9),v["\u0275\u0275elementStart"](39,"li",10),v["\u0275\u0275text"](40,"INFORMATIONS ADMINISTRATEUR"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](41,"h6",11),v["\u0275\u0275text"](42,"Identit\xe9: "),v["\u0275\u0275elementStart"](43,"span",12),v["\u0275\u0275text"](44),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](45,"div",13),v["\u0275\u0275element"](46,"div",14),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](47,"h6",11),v["\u0275\u0275text"](48,"T\xe9l\xe9phone: "),v["\u0275\u0275elementStart"](49,"span",12),v["\u0275\u0275text"](50),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](51,"div",13),v["\u0275\u0275element"](52,"div",14),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](53,"div",15),v["\u0275\u0275elementStart"](54,"nav",16),v["\u0275\u0275elementStart"](55,"div",17),v["\u0275\u0275elementStart"](56,"button",18),v["\u0275\u0275element"](57,"i",19),v["\u0275\u0275text"](58," Choix de Modules "),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](59,"div",20),v["\u0275\u0275template"](60,x,20,7,"div",21),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275element"](61,"br"),v["\u0275\u0275element"](62,"br"),v["\u0275\u0275element"](63,"br"),v["\u0275\u0275element"](64,"br"),v["\u0275\u0275element"](65,"br"),v["\u0275\u0275elementEnd"]()),2&e&&(v["\u0275\u0275property"]("hidHeader",!0)("options",!1),v["\u0275\u0275advance"](3),v["\u0275\u0275property"]("hidHeader",!0)("options",!1),v["\u0275\u0275advance"](2),v["\u0275\u0275property"]("placement","right"),v["\u0275\u0275advance"](11),v["\u0275\u0275textInterpolate1"](" ",t.user.agency.company.name,""),v["\u0275\u0275advance"](6),v["\u0275\u0275textInterpolate1"](" ",t.user.agency.company.phone,""),v["\u0275\u0275advance"](6),v["\u0275\u0275textInterpolate1"](" ",t.user.agency.company.address,""),v["\u0275\u0275advance"](6),v["\u0275\u0275textInterpolate1"](" ",t.user.agency.company.description,""),v["\u0275\u0275advance"](10),v["\u0275\u0275textInterpolate2"](" ",t.user.user.lastname,"\xa0",t.user.user.firstname,""),v["\u0275\u0275advance"](6),v["\u0275\u0275textInterpolate1"](" ",t.user.user.phone,""),v["\u0275\u0275advance"](10),v["\u0275\u0275property"]("ngForOf",t.modulesList))},directives:[b.a,c.t,c.l,i.k],pipes:[h.a],styles:[""]}),e})()}];let C=(()=>{class e{}return e.\u0275mod=v["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=v["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[o.j.forChild(E)],o.j]}),e})(),w=(()=>{class e{}return e.\u0275mod=v["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=v["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[i.b,C,r.a,a.a,s.TextMaskModule,c.d,c.h,c.u]]}),e})()}}]);